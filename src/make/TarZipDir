###############################################################################
#                                                                             #
#                                 G A M M A                                   #
#           Source Module Makefile For The GAMMA MR Simulation Platform       #
#                      Copyright © 2002 Scott A. Smith                        #
#                  National High Magnetic Field Laboratory                    #
#                         1800 E. Paul Dirac Drive                            #
#                     Tallahassee, FL, USA 32307-4005                         #
#                          ssmith@magnet.fsu.edu                              #
#                      On WWW See gamma.magnet.fsu.edu                        #
#                                                                             #
# The concern of this Makefile, TarZip, is the making of module tarballs for  #
# various GAMMA distributions. These targets handle ONLY files present herein #
# and should NEVER EVER be run recursively. That is, they expect to handle a  #
# distribtion from this directory and this directory only. Hence these are    #
# targets that are rarely used, if ever. It is far more likely that a GAMMA   #
# distribution will contain many other files than the ones contained in this  #
# directory. Hence production of tarballs is more effectively done from other #
# makefiles (after the files herein have been copied to the directory to be   #
# tarred and/or compressed).                                                  #
#                                                                             #
# Users are free to copy this file for personal use but may NOT give out      #
# modifications with or without the GAMMA platform.                           #
#                                                                             #
# Supplied Targets                                                            #
# ================                                                            #
#                                                                             #
#   disttar:    Create tar of module full   distribution in COPY2DIR          #
#   srctar:     Create tar of module source distribution in COPY2DIR          #
#   disttar:    Create tar of module header distribution in COPY2DIR          #
#   distgzip:   Create gz file from tar file produced in disttar              #
#   srcgzip:    Create gz file from tar file produced in srctar               #
#   hdrgzip:    Create gz file from tar file produced in hdrtar               #
#   distdzip:   Create zip file of module full   distribution in COPY2DIR     #
#   srcdzip:    Create zip file of module source distribution in COPY2DIR     #
#   hdrdzip:    Create zip file of module header distribution in COPY2DIR     #
#                                                                             #
# Requirements   							      #
# ============                                                                #
# MODLABEL       Cosmetic label for the source module.                        #
# COPY2DIR       Directory name where distributed file copies were put.       #
# MODULEDIR      Directory name of the source module.                         #
# GZIPPGM        Unix compression program (usually gzip)                      #
# GZIPFLGS       Unix compression program flags (usually nothing)             #
# DISTTARFILE    Tar file name, used for full   module distribution           #  
# SRCTARFILE     Tar file name, used for source module distribution           #  
# HDRTARFILE     Tar file name, used for header module distribution           #  
# DISTGZIPILE    Zip (gz) file name, used for full   module distribution      #  
# SRCGZIPFILE    Zip (gz) file name, used for source module distribution      #  
# HDRGZIPFILE    Zip (gz) file name, used for header module distribution      #  
# ZIPPGM         PC compression program (zip in unix or pkzip in windows)     #
# ZIPFLGS        PC compression program flags (-p -r for pkzip)               #
# DISTZIPILE     Zip (zip) file name, used for full   module distribution     #  
# SRCZIPFILE     Zip (zip) file name, used for source module distribution     #  
# HDRZIPFILE     Zip (zip) file name, used for header module distribution     #  
#                                                                             #
# Note: The files to be tarred and archived must be copied into directory     #
#       COPY2DIR prior to calling any of these tar targets. Similarly the     #
#       tar files must be generated prior to calling any zip targets.         #
#                                                                             #
###############################################################################


###############################################################################
#                                                                             #
#                Targets: disttar, srctar, hdrtar                             #
#                                                                             #
# These targets all do the same thing, they produce a tar file from files in  #
# the directory COPY2DIR. The directory structure is preserved. The only      #
# difference between the three targets are the name of the resulting tar      #
# file, the name is use in part to indicate the tar contents.                 #
#                                                                             #
# These targets are rarely, if ever used. First GAMMA distributions usually   #
# include many more files than those found in this source module directory.   #
# As such, distributions are made from the main GAMMA makefile, not the one   #
# for this module. Any tar file generations are then done from that make file #
# not this one. Secondly, the user must desire a Unix/GNU like tar file from  #
# this modules distribution. Otherwise this target will not/should not be     #
# run.                                                                        #
#                                                                             #
# MODLABEL       Cosmetic label for the source module.                        #
# COPY2DIR       Directory name where distributed file copies were put.       #
# MODULEDIR:     Directory name of the source module.                         #
# TARPGM         Tar program to use.                                          #
# TARFLGS        Tar program flags to use.                                    #
# DISTTARFILE    Tar file name, used for full   module distribution           #  
# SRCTARFILE     Tar file name, used for source module distribution           #  
# HDRTARFILE     Tar file name, used for header module distribution           #  
#                                                                             #
###############################################################################

disttar:
	@echo " * Generating Tar File Of GAMMA $(MODLABEL) Source Module Distribution"
	@if (test -f ${DISTTARFILE}) \
	then \
	  echo "   First Deleting Existing Tar File $(DISTTARFILE)"; \
          rm -f $(DISTTARFILE); \
	fi
	@echo "   Making New TarFile From $(COPY2DIR)"
	@echo "   Corresponds to Tarring Directory .$(MODULEDIR)"
	@$(TARPGM) $(TARFLGS) $(DISTTARFILE) $(COPY2DIR)
	@echo "   New Tar File Is $(DISTTARFILE)"

srctar:
	@echo " * Generating Tar File Of GAMMA $(MODLABEL) Sources Only"
	@if (test -f ${SRCTARFILE}) \
	then \
	  echo "   First Deleting Existing Tar File $(SRCTARFILE)"; \
          rm -f $(SRCTARFILE); \
	fi
	@echo "   Making New TarFile From $(COPY2DIR)"
	@echo "   Corresponds to Tarring Directory .$(MODULEDIR)"
	@$(TARPGM) $(TARFLGS) $(SRCTARFILE) $(COPY2DIR)
	@echo "   New Tar File Is $(SRCTARFILE)"

hdrtar:
	@echo " * Generating Tar File Of GAMMA $(MODLABEL) Headers Only"
	@if (test -f ${HDRTARFILE}) \
	then \
	  echo "   First Deleting Existing Tar File $(HDRTARFILE)"; \
          rm -f $(HDRTARFILE); \
	fi
	@echo "   Making New TarFile From $(COPY2DIR)"
	@echo "   Corresponds to Tarring Directory .$(MODULEDIR)"
	@$(TARPGM) $(TARFLGS) $(HDRTARFILE) $(COPY2DIR)
	@echo "   New Tar File Is $(HDRTARFILE)"

###############################################################################
#                                                                             #
#                  Targets: distgzip, srcgzip, hdrgzip                        #
#                           distdzip, srcdzip, hdrdzip                        #
#                                                                             #
# These targets are part of the GAMMA source module distribution targets.     #
# They are not meant to run solo. They take either 1) a single tar file in    #
# this directory  (generated from previous "tar" targets) and compresses it   #
# using (GNU) zip or 2) takes the entire source/header distribution directory #
# for the module and compresses it into a single (pkzip/zip) zip file.  In    #
# both cases the result will be a single source/header distribution file.     #
# Note that these targets should only be accessed if the Makefile is being    #
# directly, i.e. not from the main GAMMA Makefile in $GAMMAVER. If it is not  #
# being run directly, i.e. it is being run as part of a large source/header   #
# release, the earlier makefile will handle zipping up things.                #
#                                                                             #
# MODLABEL       Cosmetic label for the source module.                        #
# COPY2DIR       Directory name where distributed file copies were put.       #
# MODULEDIR      Directory name of the source module.                         #
# GZIPPGM        Unix compression program (usually gzip)                      #
# GZIPFLGS       Unix compression program flags (usually nothing)             #
# DISTTARFILE    Tar file name, used for full   module distribution           #  
# SRCTARFILE     Tar file name, used for source module distribution           #  
# HDRTARFILE     Tar file name, used for header module distribution           #  
# DISTGZIPILE    Zip (gz) file name, used for full   module distribution      #  
# SRCGZIPFILE    Zip (gz) file name, used for source module distribution      #  
# HDRGZIPFILE    Zip (gz) file name, used for header module distribution      #  
# ZIPPGM         PC compression program (zip in unix or pkzip in windows)     #
# ZIPFLGS        PC compression program flags (-p -r for pkzip)               #
# DISTZIPILE     Zip (zip) file name, used for full   module distribution     #  
# SRCZIPFILE     Zip (zip) file name, used for source module distribution     #  
# HDRZIPFILE     Zip (zip) file name, used for header module distribution     #  
#                                                                             #
###############################################################################

distgzip:
	@echo
	@echo " * Generating Zipped File Of GAMMA $(MODLABEL) Source Module Distribution"
	@echo "   The Tar File $(DISTTARFILE) Will Be Compressed Using $(GZIPPGM)"
	@if (test -f $(DISTGZIPFILE) ) \
	then \
	  echo "   First Deleting Existing Zip File $(DISTGZIPFILE)"; \
          rm -f $(DISTGZIPFILE); \
	fi
	@echo "   Making New Zip File From $(DISTTARFILE) Using $(GZIPPGM)"
	@$(GZIPPGM) $(GZIPFLGS) $(DISTTARFILE)
	@echo "   New Zip File Completed, Named $(DISTGZIPFILE) In Current Directory"
	@echo "   The Current Directory Is $(MODULEDIR)"
	
srcgzip:
	@echo
	@echo " * Generating Zipped File Of GAMMA $(MODLABEL) Source Module Sources Only"
	@echo "   The Tar File $(SRCTARFILE) Will Be Compressed Using $(GZIPPGM)"
	@if (test -f $(SRCGZIPFILE) ) \
	then \
	  echo "   First Deleting Existing Zip File $(SRCGZIPFILE)"; \
          rm -f $(SRCGZIPFILE); \
	fi
	@echo "   Making New Zip File From $(SRCTARFILE) Using $(GZIPPGM)"
	@$(GZIPPGM) $(GZIPFLGS) $(SRCTARFILE)
	@echo "   New Zip File Completed, Named $(SRCGZIPFILE) In Current Directory"
	@echo "   The Current Directory Is $(MODULEDIR)"
	
hdrgzip:
	@echo
	@echo " * Generating Zipped File Of GAMMA $(MODLABEL) Source Module Headers Only"
	@echo "   The Tar File $(HDRTARFILE) Will Be Compressed Using $(GZIPPGM)"
	@if (test -f $(HDRGZIPFILE) ) \
	then \
	  echo "   First Deleting Existing Zip File $(HDRGZIPFILE)"; \
          rm -f $(HDRGZIPFILE); \
	fi
	@echo "   Making New Zip File From $(HDRTARFILE) Using $(GZIPPGM)"
	@$(GZIPPGM) $(GZIPFLGS) $(HDRTARFILE)
	@echo "   New Zip File Completed, Named $(HDRGZIPFILE) In Current Directory";
	@echo "   The Current Directory Is $(MODULEDIR)"


distdzip:
	@echo " * Generating Zipped File Of GAMMA $(MODLABEL) Source Distribution"
	@echo "   The Directory $(COPY2BASE) Will Be Compressed Using $(ZIPPGM)"
	@$(ZIPPGM) $(ZIPFLGS) $(DISTZIPFILE) $(COPY2BASE)
	@echo "   New Zip File Completed, Named $(DISTZIPFILE) In Current Directory"
	@echo "   The Current Directory Is $(MODULEDIR)"


srcdzip:
	@echo " * Generating Zipped File Of GAMMA $(MODLABEL) Sources Only"
	@echo "   The Directory $(COPY2BASE) Will Be Compressed Using $(ZIPPGM)"
	@$(ZIPPGM) $(ZIPFLGS) $(SRCZIPFILE) $(COPY2BASE)
	@echo "   New Zip File Completed, Named $(SRCZIPFILE) In Current Directory"
	@echo "   The Current Directory Is $(MODULEDIR)"


hdrdzip:
	@echo " * Generating Zipped File Of GAMMA $(MODLABEL) Headers Only"
	@echo "   The Directory $(COPY2BASE) Will Be Compressed Using $(ZIPPGM)"
	@$(ZIPPGM) $(ZIPFLGS) $(HDRZIPFILE) $(COPY2BASE)
	@echo "   New Zip File Completed, Named $(HDRZIPFILE) In Current Directory"
	@echo "   The Current Directory Is $(MODULEDIR)"

